# Restate 에러 처리 위키 문서

## 목차
1. 개요
2. 에러 처리 전략
   - 무한 재시도와 백오프 전략
   - 터미널 에러
3. 터미널 예외 처리 방법
   - 예외 발생 코드 예시
   - 터미널 예외의 전파 및 제어 흐름
4. 핸들러 내 에러 처리

---

## 1. 개요
Restate는 분산 시스템 환경에서 안정적이고 일관된 처리를 위해 **에러 처리** 메커니즘을 제공합니다. 기본적으로 **재시도와 백오프**, **터미널 에러 처리**, **시간 초과 처리**, 그리고 사가 패턴과 연계한 **보상 트랜잭션** 처리를 지원합니다.

---

## 2. 에러 처리 전략

### 무한 재시도와 백오프 전략
- Restate는 기본적으로 **무한 재시도**를 수행합니다.
- 재시도 간에는 **지수적 백오프 (Exponential Backoff)** 전략을 적용합니다.
- 이 전략은 일시적인 오류(transient error)에 자동으로 대응하도록 설계되었습니다.

### 터미널 에러
- 특정 오류에 대해서는 재시도를 원하지 않을 수 있습니다.
- 이때는 **터미널 에러(Terminal Error)** 를 발생시켜 호출을 종료하고, 호출자에게 **오류 메시지를 전파**합니다.

---

## 3. 터미널 예외 처리 방법

### 예외 발생 코드 예시
```kotlin
throw TerminalException(500, "Something went wrong")
```
- `TerminalException`을 통해 상태 코드와 오류 메시지를 지정할 수 있습니다.
- 이는 Kotlin 또는 Java 코드 어디서든 던질 수 있습니다.

### 터미널 예외의 전파 및 제어 흐름
- 다른 서비스 호출에서 발생한 `TerminalException`을 **catch**하여 비즈니스 로직에 맞는 **제어 흐름**을 구성할 수 있습니다.
- 예를 들어, 특정 서비스 실패 시 대체 로직 수행 또는 상태 보상 작업을 트리거할 수 있습니다.

---

## 4. 핸들러 내 에러 처리
- Restate 핸들러 내부에서는 위에서 설명한 다양한 에러 처리 기법을 유기적으로 조합하여 활용할 수 있습니다.
- 일시적 오류는 자동 재시도되며, 복구 불가능한 오류는 터미널 예외로 명시적 종료를 유도할 수 있습니다.